<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Jg_types (jingoo.Jingoo.Jg_types)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">jingoo</a> &#x00BB; <a href="../index.html">Jingoo</a> &#x00BB; Jg_types</nav><h1>Module <code>Jingoo.Jg_types</code></h1></header><dl><dt class="spec exception" id="exception-SyntaxError"><a href="#exception-SyntaxError" class="anchor"></a><code><span class="keyword">exception </span></code><code><span class="exception">SyntaxError</span><span class="keyword"> of </span>string</code></dt></dl><dl><dt class="spec type" id="type-environment"><a href="#type-environment" class="anchor"></a><code><span class="keyword">type </span>environment</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-environment.autoescape" class="anchored"><td class="def field"><a href="#type-environment.autoescape" class="anchor"></a><code>autoescape : bool;</code></td><td class="doc"><p>If true, template variables are auto escaped when output.</p></td></tr><tr id="type-environment.strict_mode" class="anchored"><td class="def field"><a href="#type-environment.strict_mode" class="anchor"></a><code>strict_mode : bool;</code></td><td class="doc"><p>If true, strict type cheking is enabled. If false, some kind of invalid type usages are just ignored. for example, following expression throws exception if <code>strict_mode = true</code>, but is skipped if <code>strict_mode = false</code>.</p><pre><code class="ml">{# 3(Tint) is not iterable #}
{% for item in 3 %}
  {{ item }}
{% endfor %}</code></pre></td></tr><tr id="type-environment.template_dirs" class="anchored"><td class="def field"><a href="#type-environment.template_dirs" class="anchor"></a><code>template_dirs : string list;</code></td><td class="doc"><p>Template search path list used by <code>{% include %}</code> statements. Jingoo will always search in current directory in last resort.</p></td></tr><tr id="type-environment.filters" class="anchored"><td class="def field"><a href="#type-environment.filters" class="anchor"></a><code>filters : (string<span class="keyword"> * </span><a href="index.html#type-tvalue">tvalue</a>) list;</code></td><td class="doc"><p>User-defined filters.</p></td></tr><tr id="type-environment.extensions" class="anchored"><td class="def field"><a href="#type-environment.extensions" class="anchor"></a><code>extensions : string list;</code></td><td class="doc"><p>Path list of shared library modules (<code>.cms</code> or <code>.cmxs</code> files) which are dynamically loaded.</p></td></tr></table><code>}</code></dt><dd><p>See <a href="index.html#val-std_env"><code>std_env</code></a></p></dd></dl><dl><dt class="spec type" id="type-context"><a href="#type-context" class="anchor"></a><code><span class="keyword">type </span>context</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-context.frame_stack" class="anchored"><td class="def field"><a href="#type-context.frame_stack" class="anchor"></a><code>frame_stack : <a href="index.html#type-frame">frame</a> list;</code></td></tr><tr id="type-context.macro_table" class="anchored"><td class="def field"><a href="#type-context.macro_table" class="anchor"></a><code>macro_table : (string, <a href="index.html#type-macro">macro</a>) Stdlib.Hashtbl.t;</code></td></tr><tr id="type-context.namespace_table" class="anchored"><td class="def field"><a href="#type-context.namespace_table" class="anchor"></a><code>namespace_table : (string, <a href="index.html#type-frame">frame</a>) Stdlib.Hashtbl.t;</code></td></tr><tr id="type-context.active_filters" class="anchored"><td class="def field"><a href="#type-context.active_filters" class="anchor"></a><code>active_filters : string list;</code></td></tr><tr id="type-context.serialize" class="anchored"><td class="def field"><a href="#type-context.serialize" class="anchor"></a><code>serialize : bool;</code></td></tr><tr id="type-context.output" class="anchored"><td class="def field"><a href="#type-context.output" class="anchor"></a><code>output : string <span>&#45;&gt;</span> unit;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-frame"><a href="#type-frame" class="anchor"></a><code><span class="keyword">type </span>frame</code><code><span class="keyword"> = </span>(string, <a href="index.html#type-tvalue">tvalue</a>) Stdlib.Hashtbl.t</code></dt><dt class="spec type" id="type-macro"><a href="#type-macro" class="anchor"></a><code><span class="keyword">type </span>macro</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-macro.Macro" class="anchored"><td class="def constructor"><a href="#type-macro.Macro" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Macro</span><span class="keyword"> of </span><a href="index.html#type-macro_arg_names">macro_arg_names</a><span class="keyword"> * </span><a href="index.html#type-macro_defaults">macro_defaults</a><span class="keyword"> * </span><a href="index.html#type-macro_code">macro_code</a></code></td></tr></table></dt><dt class="spec type" id="type-macro_arg_names"><a href="#type-macro_arg_names" class="anchor"></a><code><span class="keyword">type </span>macro_arg_names</code><code><span class="keyword"> = </span>string list</code></dt><dt class="spec type" id="type-macro_defaults"><a href="#type-macro_defaults" class="anchor"></a><code><span class="keyword">type </span>macro_defaults</code><code><span class="keyword"> = </span><a href="index.html#type-kwargs">kwargs</a></code></dt><dt class="spec type" id="type-macro_code"><a href="#type-macro_code" class="anchor"></a><code><span class="keyword">type </span>macro_code</code><code><span class="keyword"> = </span><a href="index.html#type-statement">statement</a> list</code></dt><dt class="spec type" id="type-tvalue"><a href="#type-tvalue" class="anchor"></a><code><span class="keyword">type </span>tvalue</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-tvalue.Tnull" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tnull" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tnull</span></code></td></tr><tr id="type-tvalue.Tint" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tint" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tint</span><span class="keyword"> of </span>int</code></td></tr><tr id="type-tvalue.Tbool" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tbool" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tbool</span><span class="keyword"> of </span>bool</code></td></tr><tr id="type-tvalue.Tfloat" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tfloat" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tfloat</span><span class="keyword"> of </span>float</code></td></tr><tr id="type-tvalue.Tstr" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tstr" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tstr</span><span class="keyword"> of </span>string</code></td></tr><tr id="type-tvalue.Tobj" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tobj" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tobj</span><span class="keyword"> of </span>(string<span class="keyword"> * </span><a href="index.html#type-tvalue">tvalue</a>) list</code></td></tr><tr id="type-tvalue.Thash" class="anchored"><td class="def constructor"><a href="#type-tvalue.Thash" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Thash</span><span class="keyword"> of </span>(string, <a href="index.html#type-tvalue">tvalue</a>) Stdlib.Hashtbl.t</code></td></tr><tr id="type-tvalue.Tpat" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tpat" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tpat</span><span class="keyword"> of </span>string <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></td></tr><tr id="type-tvalue.Tlist" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tlist" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tlist</span><span class="keyword"> of </span><a href="index.html#type-tvalue">tvalue</a> list</code></td></tr><tr id="type-tvalue.Tset" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tset" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tset</span><span class="keyword"> of </span><a href="index.html#type-tvalue">tvalue</a> list</code></td></tr><tr id="type-tvalue.Tfun" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tfun" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tfun</span><span class="keyword"> of </span>?&#8288;kwargs:<a href="index.html#type-kwargs">kwargs</a> <span>&#45;&gt;</span> <a href="index.html#type-args">args</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></td></tr><tr id="type-tvalue.Tarray" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tarray" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tarray</span><span class="keyword"> of </span><a href="index.html#type-tvalue">tvalue</a> array</code></td></tr><tr id="type-tvalue.Tlazy" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tlazy" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tlazy</span><span class="keyword"> of </span><a href="index.html#type-tvalue">tvalue</a> Stdlib.Lazy.t</code></td></tr><tr id="type-tvalue.Tvolatile" class="anchored"><td class="def constructor"><a href="#type-tvalue.Tvolatile" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tvolatile</span><span class="keyword"> of </span>unit <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></td></tr></table></dt><dt class="spec type" id="type-args"><a href="#type-args" class="anchor"></a><code><span class="keyword">type </span>args</code><code><span class="keyword"> = </span><a href="index.html#type-tvalue">tvalue</a> list</code></dt><dt class="spec type" id="type-kwargs"><a href="#type-kwargs" class="anchor"></a><code><span class="keyword">type </span>kwargs</code><code><span class="keyword"> = </span>(string<span class="keyword"> * </span><a href="index.html#type-tvalue">tvalue</a>) list</code></dt></dl><dl><dt class="spec value" id="val-std_env"><a href="#val-std_env" class="anchor"></a><code><span class="keyword">val </span>std_env : <a href="index.html#type-environment">environment</a></code></dt><dd><pre><code class="ml">let std_env = {
  autoescape = true;
  strict_mode = false;
  template_dirs = [];
  filters = [];
  extensions = [];
}</code></pre></dd></dl><section><header><h3 id="boxing-ocaml-values"><a href="#boxing-ocaml-values" class="anchor"></a>Boxing OCaml values</h3></header><dl><dt class="spec value" id="val-box_int"><a href="#val-box_int" class="anchor"></a><code><span class="keyword">val </span>box_int : int <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_float"><a href="#val-box_float" class="anchor"></a><code><span class="keyword">val </span>box_float : float <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_string"><a href="#val-box_string" class="anchor"></a><code><span class="keyword">val </span>box_string : string <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_bool"><a href="#val-box_bool" class="anchor"></a><code><span class="keyword">val </span>box_bool : bool <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_list"><a href="#val-box_list" class="anchor"></a><code><span class="keyword">val </span>box_list : <a href="index.html#type-tvalue">tvalue</a> list <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_set"><a href="#val-box_set" class="anchor"></a><code><span class="keyword">val </span>box_set : <a href="index.html#type-tvalue">tvalue</a> list <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_obj"><a href="#val-box_obj" class="anchor"></a><code><span class="keyword">val </span>box_obj : (string<span class="keyword"> * </span><a href="index.html#type-tvalue">tvalue</a>) list <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_hash"><a href="#val-box_hash" class="anchor"></a><code><span class="keyword">val </span>box_hash : (string, <a href="index.html#type-tvalue">tvalue</a>) Stdlib.Hashtbl.t <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_array"><a href="#val-box_array" class="anchor"></a><code><span class="keyword">val </span>box_array : <a href="index.html#type-tvalue">tvalue</a> array <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_pat"><a href="#val-box_pat" class="anchor"></a><code><span class="keyword">val </span>box_pat : (string <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a>) <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_lazy"><a href="#val-box_lazy" class="anchor"></a><code><span class="keyword">val </span>box_lazy : <a href="index.html#type-tvalue">tvalue</a> Stdlib.Lazy.t <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-box_fun"><a href="#val-box_fun" class="anchor"></a><code><span class="keyword">val </span>box_fun : (?&#8288;kwargs:<a href="index.html#type-kwargs">kwargs</a> <span>&#45;&gt;</span> <a href="index.html#type-args">args</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a>) <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt></dl></section><section><header><h3 id="unboxing-ocaml-values"><a href="#unboxing-ocaml-values" class="anchor"></a>Unboxing OCaml values</h3><p>Unboxing operations raise <code>Invalid_argument</code> in case of type error.</p></header><dl><dt class="spec value" id="val-unbox_int"><a href="#val-unbox_int" class="anchor"></a><code><span class="keyword">val </span>unbox_int : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-unbox_float"><a href="#val-unbox_float" class="anchor"></a><code><span class="keyword">val </span>unbox_float : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> float</code></dt><dt class="spec value" id="val-unbox_string"><a href="#val-unbox_string" class="anchor"></a><code><span class="keyword">val </span>unbox_string : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> string</code></dt><dt class="spec value" id="val-unbox_bool"><a href="#val-unbox_bool" class="anchor"></a><code><span class="keyword">val </span>unbox_bool : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-unbox_list"><a href="#val-unbox_list" class="anchor"></a><code><span class="keyword">val </span>unbox_list : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> list</code></dt><dt class="spec value" id="val-unbox_set"><a href="#val-unbox_set" class="anchor"></a><code><span class="keyword">val </span>unbox_set : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> list</code></dt><dt class="spec value" id="val-unbox_array"><a href="#val-unbox_array" class="anchor"></a><code><span class="keyword">val </span>unbox_array : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> array</code></dt><dt class="spec value" id="val-unbox_obj"><a href="#val-unbox_obj" class="anchor"></a><code><span class="keyword">val </span>unbox_obj : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> (string<span class="keyword"> * </span><a href="index.html#type-tvalue">tvalue</a>) list</code></dt><dt class="spec value" id="val-unbox_hash"><a href="#val-unbox_hash" class="anchor"></a><code><span class="keyword">val </span>unbox_hash : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> (string, <a href="index.html#type-tvalue">tvalue</a>) Stdlib.Hashtbl.t</code></dt><dt class="spec value" id="val-unbox_pat"><a href="#val-unbox_pat" class="anchor"></a><code><span class="keyword">val </span>unbox_pat : <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt></dl></section><section><header><h3 id="helpers-for-function-writing"><a href="#helpers-for-function-writing" class="anchor"></a>Helpers for function writing</h3></header><dl><dt class="spec value" id="val-func_arg1"><a href="#val-func_arg1" class="anchor"></a><code><span class="keyword">val </span>func_arg1 : (?&#8288;kwargs:<a href="index.html#type-kwargs">kwargs</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a>) <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-func_arg2"><a href="#val-func_arg2" class="anchor"></a><code><span class="keyword">val </span>func_arg2 : (?&#8288;kwargs:<a href="index.html#type-kwargs">kwargs</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a>) <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt><dt class="spec value" id="val-func_arg3"><a href="#val-func_arg3" class="anchor"></a><code><span class="keyword">val </span>func_arg3 : (?&#8288;kwargs:<a href="index.html#type-kwargs">kwargs</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a> <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a>) <span>&#45;&gt;</span> <a href="index.html#type-tvalue">tvalue</a></code></dt></dl></section><section><header><h3 id="notes-tvalue"><a href="#notes-tvalue" class="anchor"></a>Notes about some data types</h3><p><a href="index.html#type-tvalue.Tobj"><code>tvalue.Tobj</code></a> Key/value object using an associative list.</p><p><a href="index.html#type-tvalue.Thash"><code>tvalue.Thash</code></a> Key/value objects using a hash table.</p><p><a href="index.html#type-tvalue.Tpat"><code>tvalue.Tpat</code></a> Key/value object using a function to map <code>&quot;key&quot;</code> to <code>value</code>. Faster than <a href="index.html#type-tvalue.Tobj"><code>tvalue.Tobj</code></a> and <a href="index.html#type-tvalue.Thash"><code>tvalue.Thash</code></a>, but not iterable nor testable.</p><p><a href="index.html#type-tvalue.Tset"><code>tvalue.Tset</code></a> Tuples</p><p><a href="index.html#type-tvalue.Tlazy"><code>tvalue.Tlazy</code></a> Lazy values are actually computed only when needed. Useful for recursive some data structure. In the following example, your app would throw a stack overflow without lazyness.</p><pre><code class="ml">let rec lazy_model n =
  let prev = lazy_model (n - 1) in
  let next = lazy_model (n + 1) in
  let cur = Tint n in
  Tlazy (lazy (Tobj [ (&quot;cur&quot;, cur) ; (&quot;prev&quot;, prev) ; (&quot;next&quot;, next) ]) )</code></pre><p><a href="index.html#type-tvalue.Tvolatile"><code>tvalue.Tvolatile</code></a> You can use volatile values for variables that can not be defined at model's definition time or if it is subject to changes over time on ocaml's side</p></header></section><section><header><h3 id="function-calls"><a href="#function-calls" class="anchor"></a>Function calls</h3><p>Built-in functions (aka filters) expect the <b>TARGET</b> value to be the <b>LAST</b> argument, in order to be usable with the pipe notation. You are encouraged to do the same while defining your own functions.</p><p><code>{{ x | foo (10,20) }}</code> is equivalent too <code>{{ foo (10,20,x) }}</code>.</p><p>Also, built-in function are written as functions returning functions until the last parameter is given.</p><p>It allows you to use partial application in you templates <code>{{ list | map (foo (10,20)) }}</code></p><p>There is two kind of arguments: <a href="#type-args">unnamed arguments</a> and <a href="#type-kwargs">keyword arguments</a>.</p><p>When defining a <b>keyword argument</b>, <b>label can't be omitted</b>.</p><p>You <b>can't</b> use <code>slice(4, [1,2,3,4,5], 0)</code>, because you need to explicitly bind <code>0</code> with the <code>fill_with</code> label.</p><p>A correct usage of the <code>slice</code> function would be <code>slice(4, [1,2,3,4,5], fill_with=0)</code>.</p><p>Note that kwargs may be defined at any place: <code>slice(4, fill_with=0, [1,2,3,4,5])</code>.</p></header></section></div></body></html>